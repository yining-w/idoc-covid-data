---
title: "equipment_analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
remove(list=ls())
library(readxl)
library(tidyverse)
library(ggplot2)
chemical <- read_excel("ChemicalEquip_Overtime.xlsx")

#quick cleanup
#chemical <- chemical %>% rename(bleach = "...5")
#chemical <- chemical %>% rename(arc_cleaner = "...7")
#chemical <- chemical %>% rename(peroxide = "...9")
#chemical <- chemical %>% rename(bacterial_soap = "...11")
#chemical <- chemical %>% rename(sanitizer_bottle = "...13")
chemical <- chemical %>% mutate(soap = foaming_soap + anti_bacterial_soap + bar_soap)
#change to numeric
chemical$date <- as.numeric(as.character(chemical$date))
chemical$hand_sanitizer <- as.numeric(as.character(chemical$hand_sanitizer))
chemical$foaming_soap <- as.numeric(as.character(chemical$foaming_soap))
chemical$anti_bacterial_soap <- as.numeric(as.character(chemical$anti_bacterial_soap))
chemical$bar_soap <- as.numeric(as.character(chemical$bar_soap))

chemical$industrial_cleaner <- as.numeric(as.character(chemical$industrial_cleaner))
chemical$bleach <- as.numeric(as.character(chemical$bleach))
chemical$arc_cleaner <- as.numeric(as.character(chemical$arc_cleaner))
chemical$citral_cleaner <- as.numeric(as.character(chemical$citral_cleaner))
chemical$peroxide <- as.numeric(as.character(chemical$peroxide))

chemical <- chemical %>% mutate(cleaners = industrial_cleaner + bleach + arc_cleaner + 
                                  citral_cleaner + peroxide)
#quick visual for East Moline
#Group by Prisons we're looking at
filtered <- chemical %>%
  group_by(facility) %>% 
  filter(facility =="East Moline" |
           facility == "Jacksonville" |
           facility == "Stateville" | 
           facility == "Logan" |
           facility == "Hill" |
           facility == "Menard")%>%
  ungroup()

#Hand Sanitizer
ggplot() + geom_point(aes(x=Date, y=hand_sanitizer, group=facility), 
                     data = chemical,
                     color = alpha("grey", 0.7)) +
  geom_point(aes(x=Date, y=hand_sanitizer, color=facility), 
                     data = filtered)

# soap
ggplot() + geom_point(aes(x=Date, y=soap, group=facility), 
                     data = chemical,
                     color = alpha("grey", 0.7)) +
  geom_point(aes(x=Date, y=foaming_soap, color=facility), 
                     data = filtered)

#Cleaner
ggplot() + geom_point(aes(x=Date, y=citral_cleaner, group=facility), data = chemical, color = alpha("grey", 0.7)) +
  geom_point(aes(x=Date, y=citral_cleaner, color=facility), 
                     data = filtered)


```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r filtered for scale}
#Group by Prisons we're looking at
chemical_filtered <- chemical %>% filter(soap <= 10000)

#Hand Sanitizer
ggplot() + geom_point(aes(x=Date, y=hand_sanitizer, group=facility), 
                     data = chemical_filtered,
                     color = alpha("grey", 0.7)) +
  geom_point(aes(x=Date, y=hand_sanitizer, color=facility), 
                     data = filtered)

# soap
ggplot() + geom_point(aes(x=Date, y=foaming_soap, group=facility), 
                     data = chemical,
                     color = alpha("grey", 0.7)) +
  geom_point(aes(x=Date, y=foaming_soap, color=facility), 
                     data = filtered)

#Cleaner
ggplot() + geom_point(aes(x=Date, y=, group=facility), 
                     data = chemical,
                     color =alpha("grey", 0.7)) +
  geom_point(aes(x=Date, y=cleaners, color=facility), 
                     data = filtered)

ggplot() + geom_point(aes(x=Date, y=industrial_cleaner, group=facility), 
                     data = chemical,
                     color = alpha("grey", 0.7)) +
  geom_point(aes(x=Date, y=industrial_cleaner, color=facility), 
                     data = filtered)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
